import requests
import json
import warnings
warnings.filterwarnings("ignore", "Unverified HTTPS request is being made")

proxies = {'https': 'http://johndoe:supersecret@127.0.0.1:8080'}

print("\n============== Using requests version: %s ==============\n" % requests.__version__)
response = requests.get('https://localhost:443/redirect', proxies=proxies, headers={"Authorization": "abcdef", "Cookie": "123"}, verify=False)

response_json = response.json()

print("\n============== Response received from server ==============\n")
print(json.dumps(response.json(), indent=2))

if response_json.get("Proxy-Authorization"):
    print("\nüò• Your Python requests version: %s is vulnerable to CVE-2023-32681 ‚ùå\n" % requests.__version__)
else:
    print("\nü•≥ Your Python requests version: %s is not vulnerable to CVE-2023-32681 ‚úÖ\n" % requests.__version__)
